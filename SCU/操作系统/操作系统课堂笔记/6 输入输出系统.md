
#### 1 I/O系统的功能、模型和接口
![[Pasted image 20240605143944.png|400]]
##### 基本功能
- 隐藏物理设备的细节
- 与设备的无关性
- 提高处理机和I/O设备的利用率
- 对I/O设备进行控制
- 确保对设备的正确共享
- 错误处理：机械和电气部分

##### I/O软件的层次结构
- 用户层
- 设备独立层
- 设备驱动程序
- 中断处理程序
![[Pasted image 20240605103118.png|400]]

##### I/O系统的接口
块设备接口
流设备接口
网络通信接口


#### 2 I/O设备和设备控制器
##### I/O设备
类型
- 使用特性
	存储器/外存/后备存储器/辅助存储器
	输入输出设备
- 传输速率
	低速设备
	中速设备
	高速设备
- 按信息交换的单位分类
	块设备
	字符设备
- 按设备的共享属性分类
	独占设备（可能引起进程死锁
	共享设备
	虚拟设备

设备与控制器之间的接口
![[Pasted image 20240605105153.png| 300]]
接口中有三种类型的信号，对应三条信号线
数据信号线
控制信号线
状态信号线

##### 设备控制器
实体， 控制一个或多个I/O设备
CPU与I/O设备之间的接口
可编址的设备
分类：控制字符设备的和控制块设备的

- 基本功能
接收和识别命令
数据交换
标识和报告设备
地址识别
数据缓冲
差错控制

- 组成
控制器与处理机的接口
控制器与设备的接口
I/O逻辑
![[Pasted image 20240605110602.png|300]]


##### 内存映像I/O
？？？


##### I/O通道
- I/O通道设备的引入
在CPU和设备控制器之间
独立I/O操作
一种特殊的处理机
	指令类型单一、没有自己的内存（与CPU共享内存）

- 类型
字节多路通道（不利于高速设备）
数组选择通道（利用率低）
数组多路通道（高传输速率和利用率）

- “瓶颈”问题
通道价格昂贵，数量少，系统吞吐量下降（堵车了）
解决方法：一个设备连到多个控制器上，一个控制器连到多个通路上

#### 3 中断机构和中断处理程序
##### 中断介绍
- 中断和陷入
中断/外中断：CPU对IO设备发来的中断信号的一种响应，CPU暂停正在执行的程序，保留CPU 环境后，自动地转去执行该I/O 设备的中断处理程序。执行完后，再回到断点，继续执行原来的程序

内中断/陷入(trap)：由CPU内部事件所引起的中断，CPU 暂停正在执行的程序，转去执行该陷入事件的处理程序

- 中断向量表和中断优先级
中断向量表：为每种设备配以相应的中断处理程序，并把该程序的入口地址放在中断向量表的一个表项中，并为每一个设备的中断请求规定一个中断号，它直接对应于中断向量表的一个表项中。当 I/0 设备发来中断请求信号时，由中断控制器确定该请求的中断号，根据该设备的中断号去查找中断向量表，从中取得该设备中断处理程序的入口地址，这样便可以转入中断处理程序执行。

中断优先级：每个中断源对服务要求的紧急程度并不相同，系统就需要为它们分别规定不同的优先级。

- 对多中断源的处理方式
屏蔽(禁止)中断：屏蔽掉所有的中断，处理机对任何新到的中断请求，都暂时不予理睬，而让它们等待。所有中断按顺序依次处理。简单，不能用于对实时性要求较高的中断请求

嵌套中断：当同时有多个不同优先级的中断请求时，CPU优先响应最高优先级的中断请求；高优先级的中断请求可以抢占正在运行的低优先级中断的处理机

##### 中断处理程序
- 中断处理程序的处理过程分成以下几个步骤
	- 测定是否有未响应的中断信号：停止原有进程的执行，准备转去执行中断处理程序，为把处理机的控制权转交给中断处理程序做准备
	- 保护被中断进程的CPU环境：在把控制权转交给中断处理程序之前，需要先保护被中断进程的CPU环境，以便以后能恢复运行
	- 转入相应的设备处理程序：确定引起本次中断的I/O设备，并向提供中断信号的设备发送确认信号。
	- 中断处理：对不同的设备，有不同的中断处理程序。该程序首先从设备控制器中读出设备状态，以判别本次中断是正常完成中断还是异常结束中断
	- 恢复CPU的现场并退出中断：当中断处理完成以后，需要恢复CPU的现场，退出中断。但是，此刻是否返会到被中断的进程，取决于两个因素:
		1. 屏蔽(禁止)中断方式：返回被中断的进程。
		2. 中断嵌套方式：处理优先级更高的中断请求

#### 4 设备驱动程序
设备驱动程序=设备处理程序=设备驱动进程
##### 设备驱动程序
- 功能
- 特点
- 处理方式

##### 设备驱动程序的处理过程


##### 对I/O设备的控制方式



#### 5 与设备无关的软件（设备独立性软件）
设备独立性 设备无关性

##### 基本概念
物理设备名
逻辑设备名（抽象的设备名）
	两者的转换 逻辑设备表

##### 功能
设置驱动程序的统一接口
缓冲管理
差错控制
对独立设备的分配和回收
独立于设备的逻辑数据块

##### 设备分配



#### 6 用户层的I/O软件


#### 7 缓冲区管理
###### 缓冲管理


###### 单缓冲区


###### 双缓冲区





#### 8 磁盘存储器的性能和调度
###### 磁盘存储器的管理




###### 磁盘调度








